<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VIZZU Admin - Gestao de Leads</title>
<link rel="icon" type="image/png" href="https://i.ibb.co/7dZ9GK5M/VIZZU.png">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@600;700;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{--primary:#7c3aed;--lime:#ccff00;--pink:#d500f9;--dark:#0a0a0f;--dark2:#12121a;--dark3:#1a1a24;--gray:#888;--white:#fff;--green:#22c55e;--red:#ef4444;--yellow:#eab308}
body{font-family:Inter,sans-serif;background:var(--dark);color:var(--white);min-height:100vh}
h1,h2,h3{font-family:Poppins,sans-serif}
.sidebar{position:fixed;left:0;top:0;bottom:0;width:260px;background:var(--dark2);border-right:1px solid rgba(255,255,255,.05);padding:24px;display:flex;flex-direction:column}
.sidebar-logo{display:flex;align-items:center;gap:12px;padding-bottom:24px;border-bottom:1px solid rgba(255,255,255,.1);margin-bottom:24px}
.sidebar-logo img{height:32px}
.sidebar-logo span{font-weight:700;font-size:1.1rem}
.sidebar-menu{list-style:none;flex:1}
.sidebar-menu li{margin-bottom:8px}
.sidebar-menu a{display:flex;align-items:center;gap:12px;padding:12px 16px;border-radius:10px;color:var(--gray);transition:all .3s;text-decoration:none}
.sidebar-menu a:hover,.sidebar-menu a.active{background:rgba(124,58,237,.2);color:var(--white)}
.sidebar-menu a.active{border-left:3px solid var(--lime)}
.sidebar-menu i{width:20px;text-align:center}
.main{margin-left:260px;padding:32px}
.header{display:flex;justify-content:space-between;align-items:center;margin-bottom:32px}
.header h1{font-size:1.8rem}
.header-actions{display:flex;gap:12px}
.btn{display:inline-flex;align-items:center;gap:8px;padding:12px 20px;border-radius:10px;font-weight:600;font-size:.9rem;cursor:pointer;border:none;transition:all .3s}
.btn-primary{background:var(--primary);color:var(--white)}
.btn-primary:hover{background:var(--pink)}
.btn-lime{background:var(--lime);color:var(--dark)}
.btn-outline{background:transparent;border:1px solid rgba(255,255,255,.2);color:var(--white)}
.btn-outline:hover{border-color:var(--primary);color:var(--primary)}
.btn-sm{padding:8px 14px;font-size:.8rem}
.btn-danger{background:var(--red);color:var(--white)}
.btn-success{background:var(--green);color:var(--white)}
.stats-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:20px;margin-bottom:32px}
.stat-card{background:var(--dark2);border:1px solid rgba(255,255,255,.05);border-radius:16px;padding:24px}
.stat-card-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px}
.stat-card-icon{width:48px;height:48px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:1.3rem}
.stat-card-icon.purple{background:rgba(124,58,237,.2);color:var(--primary)}
.stat-card-icon.green{background:rgba(34,197,94,.2);color:var(--green)}
.stat-card-icon.yellow{background:rgba(234,179,8,.2);color:var(--yellow)}
.stat-card-icon.pink{background:rgba(213,0,249,.2);color:var(--pink)}
.stat-value{font-size:2.2rem;font-weight:800;font-family:Poppins}
.stat-label{color:var(--gray);font-size:.9rem;margin-top:4px}
.card{background:var(--dark2);border:1px solid rgba(255,255,255,.05);border-radius:16px;overflow:hidden}
.card-header{display:flex;justify-content:space-between;align-items:center;padding:20px 24px;border-bottom:1px solid rgba(255,255,255,.05)}
.card-header h2{font-size:1.2rem}
.search-box{display:flex;align-items:center;gap:8px;background:var(--dark3);border:1px solid rgba(255,255,255,.1);border-radius:8px;padding:10px 14px}
.search-box input{background:transparent;border:none;color:var(--white);outline:none;font-size:.9rem;width:200px}
.search-box input::placeholder{color:var(--gray)}
.search-box i{color:var(--gray)}
table{width:100%;border-collapse:collapse}
th,td{padding:16px 24px;text-align:left}
th{background:var(--dark3);font-weight:600;font-size:.85rem;color:var(--gray);text-transform:uppercase;letter-spacing:1px}
td{border-bottom:1px solid rgba(255,255,255,.05);font-size:.9rem}
tr:hover td{background:rgba(255,255,255,.02)}
.lead-name{font-weight:600}
.lead-contact{color:var(--gray);font-size:.85rem}
.badge{display:inline-flex;align-items:center;gap:6px;padding:6px 12px;border-radius:20px;font-size:.75rem;font-weight:600;text-transform:uppercase}
.badge-novo{background:rgba(34,197,94,.2);color:var(--green)}
.badge-contato{background:rgba(234,179,8,.2);color:var(--yellow)}
.badge-proposta{background:rgba(124,58,237,.2);color:var(--primary)}
.badge-fechado{background:rgba(204,255,0,.2);color:var(--lime)}
.badge-perdido{background:rgba(239,68,68,.2);color:var(--red)}
.actions{display:flex;gap:8px}
.action-btn{width:36px;height:36px;border-radius:8px;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .3s}
.action-btn.whatsapp{background:rgba(37,211,102,.2);color:#25d366}
.action-btn.whatsapp:hover{background:#25d366;color:#fff}
.action-btn.edit{background:rgba(124,58,237,.2);color:var(--primary)}
.action-btn.edit:hover{background:var(--primary);color:#fff}
.action-btn.delete{background:rgba(239,68,68,.2);color:var(--red)}
.action-btn.delete:hover{background:var(--red);color:#fff}
.empty-state{text-align:center;padding:60px 24px;color:var(--gray)}
.empty-state i{font-size:3rem;margin-bottom:16px;color:var(--primary)}
.empty-state h3{color:var(--white);margin-bottom:8px}
.modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,.8);backdrop-filter:blur(10px);z-index:1000;display:flex;align-items:center;justify-content:center;opacity:0;visibility:hidden;transition:all .3s}
.modal-overlay.active{opacity:1;visibility:visible}
.modal{background:var(--dark2);border:1px solid rgba(255,255,255,.1);border-radius:20px;padding:32px;max-width:500px;width:90%;position:relative}
.modal-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}
.modal-header h3{font-size:1.3rem}
.modal-close{width:36px;height:36px;background:rgba(255,255,255,.1);border:none;border-radius:50%;color:var(--white);cursor:pointer;display:flex;align-items:center;justify-content:center}
.modal-close:hover{background:var(--red)}
.form-group{margin-bottom:16px}
.form-group label{display:block;font-size:.85rem;color:var(--gray);margin-bottom:8px}
.form-group input,.form-group select,.form-group textarea{width:100%;padding:12px 14px;background:var(--dark3);border:1px solid rgba(255,255,255,.1);border-radius:8px;color:var(--white);font-size:.95rem}
.form-group input:focus,.form-group select:focus,.form-group textarea:focus{outline:none;border-color:var(--primary)}
.form-group select{cursor:pointer}
.form-group textarea{resize:vertical;min-height:80px}
.form-actions{display:flex;gap:12px;margin-top:24px}
.form-actions .btn{flex:1}
.status-select{padding:6px 10px;background:var(--dark3);border:1px solid rgba(255,255,255,.1);border-radius:6px;color:var(--white);font-size:.8rem;cursor:pointer}
.status-select:focus{outline:none;border-color:var(--primary)}
.toast{position:fixed;bottom:24px;right:24px;background:var(--dark2);border:1px solid var(--green);border-radius:12px;padding:16px 24px;display:flex;align-items:center;gap:12px;z-index:2000;transform:translateX(150%);transition:transform .4s}
.toast.show{transform:translateX(0)}
.toast i{color:var(--green);font-size:1.3rem}
@media(max-width:1200px){.stats-grid{grid-template-columns:repeat(2,1fr)}}
@media(max-width:900px){.sidebar{width:70px;padding:16px}.sidebar-logo span,.sidebar-menu span{display:none}.sidebar-menu a{justify-content:center;padding:12px}.main{margin-left:70px}}
@media(max-width:600px){.sidebar{display:none}.main{margin-left:0}.stats-grid{grid-template-columns:1fr}.header{flex-direction:column;gap:16px;align-items:flex-start}table{display:block;overflow-x:auto}}
</style>
</head>
<body>
<aside class="sidebar">
<div class="sidebar-logo">
<img src="https://i.ibb.co/7dZ9GK5M/VIZZU.png" alt="VIZZU">
<span>Admin</span>
</div>
<ul class="sidebar-menu">
<li><a href="#" class="active"><i class="fas fa-users"></i><span>Leads</span></a></li>
<li><a href="#" onclick="alert('Em breve!')"><i class="fas fa-file-invoice"></i><span>Propostas</span></a></li>
<li><a href="#" onclick="alert('Em breve!')"><i class="fas fa-chart-bar"></i><span>Relatorios</span></a></li>
<li><a href="#" onclick="alert('Em breve!')"><i class="fas fa-cog"></i><span>Config</span></a></li>
</ul>
<a href="index.html" class="btn btn-outline" style="margin-top:auto"><i class="fas fa-external-link-alt"></i><span>Ver Site</span></a>
</aside>

<main class="main">
<div class="header">
<h1><i class="fas fa-users"></i> Gestao de Leads</h1>
<div class="header-actions">
<button class="btn btn-outline" onclick="exportLeads()"><i class="fas fa-download"></i> Exportar</button>
<button class="btn btn-lime" onclick="openAddModal()"><i class="fas fa-plus"></i> Novo Lead</button>
</div>
</div>

<div class="stats-grid">
<div class="stat-card">
<div class="stat-card-header">
<div class="stat-card-icon purple"><i class="fas fa-users"></i></div>
</div>
<div class="stat-value" id="totalLeads">0</div>
<div class="stat-label">Total de Leads</div>
</div>
<div class="stat-card">
<div class="stat-card-header">
<div class="stat-card-icon green"><i class="fas fa-user-plus"></i></div>
</div>
<div class="stat-value" id="novosLeads">0</div>
<div class="stat-label">Leads Novos</div>
</div>
<div class="stat-card">
<div class="stat-card-header">
<div class="stat-card-icon yellow"><i class="fas fa-handshake"></i></div>
</div>
<div class="stat-value" id="emContato">0</div>
<div class="stat-label">Em Contato</div>
</div>
<div class="stat-card">
<div class="stat-card-header">
<div class="stat-card-icon pink"><i class="fas fa-trophy"></i></div>
</div>
<div class="stat-value" id="fechados">0</div>
<div class="stat-label">Fechados</div>
</div>
</div>

<div class="card">
<div class="card-header">
<h2>Todos os Leads</h2>
<div class="search-box">
<i class="fas fa-search"></i>
<input type="text" placeholder="Buscar lead..." id="searchInput" oninput="filterLeads()">
</div>
</div>
<div id="leadsTable">
<table>
<thead>
<tr>
<th>Lead</th>
<th>Contato</th>
<th>Instagram/Site</th>
<th>Data</th>
<th>Status</th>
<th>Acoes</th>
</tr>
</thead>
<tbody id="leadsBody"></tbody>
</table>
</div>
<div class="empty-state" id="emptyState" style="display:none">
<i class="fas fa-inbox"></i>
<h3>Nenhum lead ainda</h3>
<p>Os leads capturados na landing page aparecerao aqui.</p>
</div>
</div>
</main>

<div class="modal-overlay" id="leadModal">
<div class="modal">
<div class="modal-header">
<h3 id="modalTitle">Novo Lead</h3>
<button class="modal-close" onclick="closeModal()"><i class="fas fa-times"></i></button>
</div>
<form id="leadForm" onsubmit="saveLead(event)">
<input type="hidden" id="leadId">
<div class="form-group">
<label>Nome completo *</label>
<input type="text" id="leadNome" required>
</div>
<div class="form-group">
<label>WhatsApp *</label>
<input type="tel" id="leadTelefone" required>
</div>
<div class="form-group">
<label>Email *</label>
<input type="email" id="leadEmail" required>
</div>
<div class="form-group">
<label>Instagram/Site</label>
<input type="text" id="leadInstagram">
</div>
<div class="form-group">
<label>Status</label>
<select id="leadStatus">
<option value="novo">Novo</option>
<option value="contato">Em Contato</option>
<option value="proposta">Proposta Enviada</option>
<option value="fechado">Fechado</option>
<option value="perdido">Perdido</option>
</select>
</div>
<div class="form-group">
<label>Observacoes</label>
<textarea id="leadObs" placeholder="Anotacoes sobre o lead..."></textarea>
</div>
<div class="form-actions">
<button type="button" class="btn btn-outline" onclick="closeModal()">Cancelar</button>
<button type="submit" class="btn btn-lime">Salvar</button>
</div>
</form>
</div>
</div>

<div class="toast" id="toast"><i class="fas fa-check-circle"></i><span id="toastMsg">Sucesso!</span></div>

<script>
let leads = JSON.parse(localStorage.getItem('vizzu_leads') || '[]');

function renderLeads() {
    updateStats();
    const tbody = document.getElementById('leadsBody');
    const emptyState = document.getElementById('emptyState');
    const table = document.getElementById('leadsTable');
    
    if (leads.length === 0) {
        table.style.display = 'none';
        emptyState.style.display = 'block';
        return;
    }
    
    table.style.display = 'block';
    emptyState.style.display = 'none';
    
    tbody.innerHTML = leads.map(lead => `
        <tr>
            <td>
                <div class="lead-name">${lead.nome}</div>
                <div class="lead-contact">${lead.desconto || ''}</div>
            </td>
            <td>
                <div>${lead.telefone}</div>
                <div class="lead-contact">${lead.email}</div>
            </td>
            <td>${lead.instagram || '-'}</td>
            <td>${lead.data}</td>
            <td>
                <select class="status-select" onchange="updateStatus(${lead.id}, this.value)">
                    <option value="novo" ${lead.status==='novo'?'selected':''}>Novo</option>
                    <option value="contato" ${lead.status==='contato'?'selected':''}>Em Contato</option>
                    <option value="proposta" ${lead.status==='proposta'?'selected':''}>Proposta</option>
                    <option value="fechado" ${lead.status==='fechado'?'selected':''}>Fechado</option>
                    <option value="perdido" ${lead.status==='perdido'?'selected':''}>Perdido</option>
                </select>
            </td>
            <td>
                <div class="actions">
                    <button class="action-btn whatsapp" onclick="openWhatsApp('${lead.telefone}','${lead.nome}')" title="WhatsApp">
                        <i class="fab fa-whatsapp"></i>
                    </button>
                    <button class="action-btn edit" onclick="editLead(${lead.id})" title="Editar">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button class="action-btn delete" onclick="deleteLead(${lead.id})" title="Excluir">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            </td>
        </tr>
    `).join('');
}

function updateStats() {
    document.getElementById('totalLeads').textContent = leads.length;
    document.getElementById('novosLeads').textContent = leads.filter(l => l.status === 'novo').length;
    document.getElementById('emContato').textContent = leads.filter(l => l.status === 'contato' || l.status === 'proposta').length;
    document.getElementById('fechados').textContent = leads.filter(l => l.status === 'fechado').length;
}

function updateStatus(id, status) {
    leads = leads.map(l => l.id === id ? {...l, status} : l);
    localStorage.setItem('vizzu_leads', JSON.stringify(leads));
    updateStats();
    showToast('Status atualizado!');
}

function openAddModal() {
    document.getElementById('modalTitle').textContent = 'Novo Lead';
    document.getElementById('leadForm').reset();
    document.getElementById('leadId').value = '';
    document.getElementById('leadModal').classList.add('active');
}

function editLead(id) {
    const lead = leads.find(l => l.id === id);
    if (!lead) return;
    
    document.getElementById('modalTitle').textContent = 'Editar Lead';
    document.getElementById('leadId').value = lead.id;
    document.getElementById('leadNome').value = lead.nome;
    document.getElementById('leadTelefone').value = lead.telefone;
    document.getElementById('leadEmail').value = lead.email;
    document.getElementById('leadInstagram').value = lead.instagram || '';
    document.getElementById('leadStatus').value = lead.status;
    document.getElementById('leadObs').value = lead.obs || '';
    document.getElementById('leadModal').classList.add('active');
}

function closeModal() {
    document.getElementById('leadModal').classList.remove('active');
}

function saveLead(e) {
    e.preventDefault();
    const id = document.getElementById('leadId').value;
    const leadData = {
        nome: document.getElementById('leadNome').value,
        telefone: document.getElementById('leadTelefone').value,
        email: document.getElementById('leadEmail').value,
        instagram: document.getElementById('leadInstagram').value,
        status: document.getElementById('leadStatus').value,
        obs: document.getElementById('leadObs').value
    };
    
    if (id) {
        leads = leads.map(l => l.id === parseInt(id) ? {...l, ...leadData} : l);
        showToast('Lead atualizado!');
    } else {
        leadData.id = Date.now();
        leadData.data = new Date().toLocaleString('pt-BR');
        leads.push(leadData);
        showToast('Lead adicionado!');
    }
    
    localStorage.setItem('vizzu_leads', JSON.stringify(leads));
    closeModal();
    renderLeads();
}

function deleteLead(id) {
    if (!confirm('Excluir este lead?')) return;
    leads = leads.filter(l => l.id !== id);
    localStorage.setItem('vizzu_leads', JSON.stringify(leads));
    renderLeads();
    showToast('Lead excluido!');
}

function openWhatsApp(telefone, nome) {
    const tel = telefone.replace(/\D/g, '');
    const msg = encodeURIComponent(`Ola ${nome}! Aqui e da VIZZU Digital. Vi que voce se cadastrou para o desconto de 10%. Vamos conversar sobre a transformacao da sua loja?`);
    window.open(`https://wa.me/55${tel}?text=${msg}`, '_blank');
}

function filterLeads() {
    const search = document.getElementById('searchInput').value.toLowerCase();
    const filtered = leads.filter(l => 
        l.nome.toLowerCase().includes(search) ||
        l.email.toLowerCase().includes(search) ||
        l.telefone.includes(search)
    );
    
    const tbody = document.getElementById('leadsBody');
    if (filtered.length === 0) {
        tbody.innerHTML = '<tr><td colspan="6" style="text-align:center;color:var(--gray);padding:40px">Nenhum resultado encontrado</td></tr>';
        return;
    }
    
    tbody.innerHTML = filtered.map(lead => `
        <tr>
            <td><div class="lead-name">${lead.nome}</div><div class="lead-contact">${lead.desconto || ''}</div></td>
            <td><div>${lead.telefone}</div><div class="lead-contact">${lead.email}</div></td>
            <td>${lead.instagram || '-'}</td>
            <td>${lead.data}</td>
            <td><select class="status-select" onchange="updateStatus(${lead.id}, this.value)"><option value="novo" ${lead.status==='novo'?'selected':''}>Novo</option><option value="contato" ${lead.status==='contato'?'selected':''}>Em Contato</option><option value="proposta" ${lead.status==='proposta'?'selected':''}>Proposta</option><option value="fechado" ${lead.status==='fechado'?'selected':''}>Fechado</option><option value="perdido" ${lead.status==='perdido'?'selected':''}>Perdido</option></select></td>
            <td><div class="actions"><button class="action-btn whatsapp" onclick="openWhatsApp('${lead.telefone}','${lead.nome}')"><i class="fab fa-whatsapp"></i></button><button class="action-btn edit" onclick="editLead(${lead.id})"><i class="fas fa-edit"></i></button><button class="action-btn delete" onclick="deleteLead(${lead.id})"><i class="fas fa-trash"></i></button></div></td>
        </tr>
    `).join('');
}

function exportLeads() {
    if (leads.length === 0) {
        alert('Nenhum lead para exportar!');
        return;
    }
    
    let csv = 'Nome,Telefone,Email,Instagram,Data,Status\n';
    leads.forEach(l => {
        csv += `"${l.nome}","${l.telefone}","${l.email}","${l.instagram || ''}","${l.data}","${l.status}"\n`;
    });
    
    const blob = new Blob([csv], {type: 'text/csv'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'vizzu_leads_' + new Date().toISOString().split('T')[0] + '.csv';
    a.click();
    showToast('Leads exportados!');
}

function showToast(msg) {
    const toast = document.getElementById('toast');
    document.getElementById('toastMsg').textContent = msg;
    toast.classList.add('show');
    setTimeout(() => toast.classList.remove('show'), 3000);
}

renderLeads();
</script>
</body>
</html>
